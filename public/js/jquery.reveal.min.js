(function(a){a.fn.reveal=function(b){var b=a.extend({},{animation:'fade',animationspeed:200,closeonbackgroundclick:!1,dismissmodalclass:'close-modal'},b);return this.each(function(){function d(){j=!1}function f(){j=!0}var g=a(this),h=parseInt(g.css('top')),i=g.height()+h,j=!1,k=a('.reveal-modal-bg');0==k.length&&(k=a('<div class="reveal-modal-bg" />').insertAfter(g)),g.bind('reveal:open',function(){k.unbind('click.modalEvent'),a('.'+b.dismissmodalclass).unbind('click.modalEvent'),j||(f(),'fadeAndPop'==b.animation&&(g.css({top:a(document).scrollTop()-i,opacity:0,visibility:'visible',display:'block'}),k.fadeIn(b.animationspeed/2),g.delay(b.animationspeed/2).animate({top:a(document).scrollTop()+h+'px',opacity:1},b.animationspeed,d())),'fade'==b.animation&&(g.css({opacity:0,visibility:'visible',display:'block',display:'block',top:a(document).scrollTop()+h}),k.fadeIn(b.animationspeed/2),g.delay(b.animationspeed/2).animate({opacity:1},b.animationspeed,d())),'none'==b.animation&&(g.css({visibility:'visible',display:'block',top:a(document).scrollTop()+h}),k.css({display:'block'}),d())),g.unbind('reveal:open')}),g.bind('reveal:close',function(){j||(f(),'fadeAndPop'==b.animation&&(k.delay(b.animationspeed).fadeOut(b.animationspeed),g.animate({top:a(document).scrollTop()-i+'px',opacity:0},b.animationspeed/2,function(){g.css({top:h,opacity:1,visibility:'hidden'}),d()})),'fade'==b.animation&&(k.delay(b.animationspeed).fadeOut(b.animationspeed),g.animate({opacity:0},b.animationspeed,function(){g.css({opacity:1,visibility:'hidden',top:h}),d()})),'none'==b.animation&&(g.css({visibility:'hidden',top:h}),k.css({display:'none'}))),g.unbind('reveal:close')}),g.trigger('reveal:open');a('.'+b.dismissmodalclass).bind('click.modalEvent',function(){g.trigger('reveal:close')});b.closeonbackgroundclick&&(k.css({cursor:'pointer'}),k.bind('click.modalEvent',function(){g.trigger('reveal:close')})),a('body').keyup(function(m){27===m.which&&g.trigger('reveal:close')})})}})(jQuery);
